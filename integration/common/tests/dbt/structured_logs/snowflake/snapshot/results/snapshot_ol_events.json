[
  {
    "eventTime":"2024-12-13T13:58:32.510714Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"dbt-run-jaffle_shop",
      "facets":{ }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:54.455582Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"dbt-run-jaffle_shop"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SNAPSHOT"
        }
      }
    },
    "eventType":"START",
    "inputs":[
      {
        "namespace":"snowflake://mysnowflakeaccount.us-east-1.aws",
        "name":"REPORTING.TEST_GENERAL.raw_orders",
        "facets":{
          "dataSource":{
            "name":"snowflake://mysnowflakeaccount.us-east-1.aws",
            "uri":"snowflake://mysnowflakeaccount.us-east-1.aws"
          },
          "schema":{
            "fields":[ ]
          },
          "documentation":{
            "description":""
          }
        }
      }
    ],
    "outputs":[
      {
        "namespace":"snowflake://mysnowflakeaccount.us-east-1.aws",
        "name":"REPORTING.snapshots.orders_snapshot",
        "facets":{
          "dataSource":{
            "name":"snowflake://mysnowflakeaccount.us-east-1.aws",
            "uri":"snowflake://mysnowflakeaccount.us-east-1.aws"
          },
          "schema":{
            "fields":[ ]
          },
          "documentation":{
            "description":""
          }
        },
        "outputFacets":{ }
      }
    ]
  },
  {
    "eventTime":"2024-12-13T13:58:54.917912Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.1",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:55.964863Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.1",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:56.269158Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.2",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ncreate or replace temporary table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\"\n         as\n        (\n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n        );"
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:57.413443Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.2",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ncreate or replace temporary table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\"\n         as\n        (\n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n        );"
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:57.482926Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.3",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:57.781202Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.3",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:57.837340Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.4",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:58.107733Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.4",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:58.154009Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.5",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:58.405168Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.5",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:58.469653Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.6",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:58.806994Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.6",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:58.895431Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.7",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:59.161553Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.7",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:59.333754Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.8",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        \n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n    ) as __dbt_sbq\n    where false\n    limit 0"
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:59.758529Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.8",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        \n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n    ) as __dbt_sbq\n    where false\n    limit 0"
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:58:59.830409Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.9",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time\n    ) as __dbt_sbq\n    where false\n    limit 0"
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:00.095233Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.9",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time\n    ) as __dbt_sbq\n    where false\n    limit 0"
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:00.198464Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.10",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nBEGIN"
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:00.483457Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.10",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nBEGIN"
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:00.517837Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.11",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nmerge into \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\" as DBT_INTERNAL_DEST\n    using \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\" as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     \n       and DBT_INTERNAL_DEST.dbt_valid_to is null\n     \n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n        values (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n\n;"
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:01.323349Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.11",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nmerge into \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\" as DBT_INTERNAL_DEST\n    using \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\" as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     \n       and DBT_INTERNAL_DEST.dbt_valid_to is null\n     \n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n        values (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n\n;"
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:01.358393Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.12",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nCOMMIT"
        }
      }
    },
    "eventType":"START",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:01.945719Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot.sql.12",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SQL"
        },
        "sql":{
          "query":"/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nCOMMIT"
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  },
  {
    "eventTime":"2024-12-13T13:59:02.710853Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "parent":{
          "run":{
            "runId":"{{ any(result) }}"
          },
          "job":{
            "namespace":"dbt-test-namespace",
            "name":"dbt-run-jaffle_shop"
          }
        },
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"REPORTING.snapshots.jaffle_shop.orders_snapshot.snapshot",
      "facets":{
        "jobType":{
          "processingType":"BATCH",
          "integration":"DBT",
          "jobType":"SNAPSHOT"
        }
      }
    },
    "eventType":"COMPLETE",
    "inputs":[
      {
        "namespace":"snowflake://mysnowflakeaccount.us-east-1.aws",
        "name":"REPORTING.TEST_GENERAL.raw_orders",
        "facets":{
          "dataSource":{
            "name":"snowflake://mysnowflakeaccount.us-east-1.aws",
            "uri":"snowflake://mysnowflakeaccount.us-east-1.aws"
          },
          "schema":{
            "fields":[ ]
          },
          "documentation":{
            "description":""
          }
        }
      }
    ],
    "outputs":[
      {
        "namespace":"snowflake://mysnowflakeaccount.us-east-1.aws",
        "name":"REPORTING.snapshots.orders_snapshot",
        "facets":{
          "dataSource":{
            "name":"snowflake://mysnowflakeaccount.us-east-1.aws",
            "uri":"snowflake://mysnowflakeaccount.us-east-1.aws"
          },
          "schema":{
            "fields":[ ]
          },
          "documentation":{
            "description":""
          }
        },
        "outputFacets":{ }
      }
    ]
  },
  {
    "eventTime":"2024-12-13T13:59:03.535811Z",
    "run":{
      "runId":"{{ any(result) }}",
      "facets":{
        "dbt_version":{
          "version":"1.8.2"
        }
      }
    },
    "job":{
      "namespace":"dbt-test-namespace",
      "name":"dbt-run-jaffle_shop",
      "facets":{ }
    },
    "eventType":"COMPLETE",
    "inputs":[ ],
    "outputs":[ ]
  }
]