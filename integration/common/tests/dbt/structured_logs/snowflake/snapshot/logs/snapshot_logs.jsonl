{"data": {"log_version": 3, "version": "=1.8.2"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Running with dbt=1.8.2", "name": "MainReportVersion", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:32.510714Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt snapshot --select orders_snapshot --profiles-dir profiles --log-format json --target snowflake --debug", "log_cache_events": "False", "log_format": "json", "log_path": "/usr/src/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "profiles", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "False", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profiles', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/src/dbt/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --select orders_snapshot --profiles-dir profiles --log-format json --target snowflake --debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:32.523650Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Registered adapter: snowflake=1.8.2", "name": "AdapterRegistered", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:34.485520Z"}}
{"data": {"checksum": "588291a884d4954dfe5869f815c6a2d49221562edb8a069ce101ce504fd5c9ec", "profile": "", "target": "snowflake", "vars": "{}", "version": "1.8.2"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "checksum: 588291a884d4954dfe5869f815c6a2d49221562edb8a069ce101ce504fd5c9ec, vars: {}, profile: , target: snowflake, version: 1.8.2", "name": "StateCheckVarsHash", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:34.943543Z"}}
{"data": {"reason": "saved manifest not found. Starting full parse."}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Unable to do partial parsing because saved manifest not found. Starting full parse.", "name": "UnableToPartialParse", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:34.967258Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "warn", "msg": "[WARNING]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:43.667967Z"}}
{"data": {"stat_line": "5 models, 1 snapshot, 3 seeds, 20 data tests, 459 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Found 5 models, 1 snapshot, 3 seeds, 20 data tests, 459 macros", "name": "FoundStats", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:46.519682Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "", "name": "Formatting", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:46.533632Z"}}
{"data": {"conn_name": "master", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Acquiring new snowflake connection 'master'", "name": "NewConnection", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:46.540641Z"}}
{"data": {"conn_name": "list_REPORTING", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Acquiring new snowflake connection 'list_REPORTING'", "name": "NewConnection", "pid": 801, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:58:46.554276Z"}}
{"data": {"conn_name": "list_REPORTING", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"list_REPORTING\"", "name": "ConnectionUsed", "pid": 801, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:58:46.640064Z"}}
{"data": {"conn_name": "list_REPORTING", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"connection_name\": \"list_REPORTING\"} */\nshow terse schemas in database REPORTING\n    limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On list_REPORTING: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"connection_name\": \"list_REPORTING\"} */\nshow terse schemas in database REPORTING\n    limit 10000", "name": "SQLQuery", "pid": 801, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:58:46.646959Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 801, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:58:46.654015Z"}}
{"data": {"elapsed": 1.4948293, "query_id": "01b90106-0412-7043-2a66-0301e5fdcd6b", "status": "SUCCESS 208"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 208 in 1.495 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:58:48.133674Z"}}
{"data": {"conn_name": "list_REPORTING"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On list_REPORTING: Close", "name": "ConnectionClosed", "pid": 801, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:58:48.190122Z"}}
{"data": {"conn_name": "list_REPORTING_TEST_GENERAL", "orig_conn_name": "list_REPORTING"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_REPORTING, now list_REPORTING_TEST_GENERAL)", "name": "ConnectionReused", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:48.757570Z"}}
{"data": {"conn_name": "list_REPORTING_TEST_GENERAL", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"list_REPORTING_TEST_GENERAL\"", "name": "ConnectionUsed", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:48.821711Z"}}
{"data": {"conn_name": "list_REPORTING_TEST_GENERAL", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"connection_name\": \"list_REPORTING_TEST_GENERAL\"} */\nshow objects in REPORTING.TEST_GENERAL limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On list_REPORTING_TEST_GENERAL: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"connection_name\": \"list_REPORTING_TEST_GENERAL\"} */\nshow objects in REPORTING.TEST_GENERAL limit 10000", "name": "SQLQuery", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:48.830095Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:48.836950Z"}}
{"data": {"elapsed": 2.0665598, "query_id": "01b90106-0412-6f39-2a66-0301e5fdd2cf", "status": "SUCCESS 1194"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 1194 in 2.067 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:50.903904Z"}}
{"data": {"conn_name": "list_REPORTING_TEST_GENERAL"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On list_REPORTING_TEST_GENERAL: Close", "name": "ConnectionClosed", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:51.925894Z"}}
{"data": {"conn_name": "list_REPORTING_snapshots", "orig_conn_name": "list_REPORTING_TEST_GENERAL"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_REPORTING_TEST_GENERAL, now list_REPORTING_snapshots)", "name": "ConnectionReused", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:52.435828Z"}}
{"data": {"conn_name": "list_REPORTING_snapshots", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"list_REPORTING_snapshots\"", "name": "ConnectionUsed", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:52.496373Z"}}
{"data": {"conn_name": "list_REPORTING_snapshots", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"connection_name\": \"list_REPORTING_snapshots\"} */\nshow objects in REPORTING.snapshots limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On list_REPORTING_snapshots: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"connection_name\": \"list_REPORTING_snapshots\"} */\nshow objects in REPORTING.snapshots limit 10000", "name": "SQLQuery", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:52.514125Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:52.536949Z"}}
{"data": {"elapsed": 1.3281977, "query_id": "01b90106-0412-7039-2a66-0301e5fdbf67", "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 1 in 1.328 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:53.866208Z"}}
{"data": {"conn_name": "list_REPORTING_snapshots"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On list_REPORTING_snapshots: Close", "name": "ConnectionClosed", "pid": 801, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-12-13T13:58:53.892531Z"}}
{"data": {"node_count": 1, "num_threads": 1, "target_name": "snowflake"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Concurrency: 1 threads (target='snowflake')", "name": "ConcurrencyLine", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:54.413967Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "", "name": "Formatting", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:58:54.431104Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "started", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Began running node snapshot.jaffle_shop.orders_snapshot", "name": "NodeStart", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.457507Z"}}
{"data": {"description": "snapshot snapshots.orders_snapshot", "index": 1, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "started", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "1 of 1 START snapshot snapshots.orders_snapshot ................................ [RUN]", "name": "LogStartLine", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.468127Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "orig_conn_name": "list_REPORTING_snapshots"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_REPORTING_snapshots, now snapshot.jaffle_shop.orders_snapshot)", "name": "ConnectionReused", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.477365Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "compiling", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Began compiling node snapshot.jaffle_shop.orders_snapshot", "name": "NodeCompiling", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.484399Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Began executing node snapshot.jaffle_shop.orders_snapshot", "name": "NodeExecuting", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.545188Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.909082Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.917912Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:54.925617Z"}}
{"data": {"elapsed": 1.0376592, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-6f39-2a66-0301e5fdd3ff", "status": "SUCCESS 8"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 8 in 1.038 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:55.964863Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:56.260019Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ncreate or replace temporary table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\"\n         as\n        (\n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n        );"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ncreate or replace temporary table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\"\n         as\n        (\n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n        );", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:56.269158Z"}}
{"data": {"elapsed": 1.1316804, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-7039-2a66-0301e5fdbff3", "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 1 in 1.132 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:57.413443Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:57.471710Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\"", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:57.482926Z"}}
{"data": {"elapsed": 0.28859887, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-7043-2a66-0301e5fdcf4f", "status": "SUCCESS 10"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 10 in 0.289 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:57.781202Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:57.829477Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:57.837340Z"}}
{"data": {"elapsed": 0.25553071, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-6f39-2a66-0301e5fdd45b", "status": "SUCCESS 8"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 8 in 0.256 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.107733Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.146554Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\"", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.154009Z"}}
{"data": {"elapsed": 0.24164213, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-7039-2a66-0301e5fde047", "status": "SUCCESS 10"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 10 in 0.242 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.405168Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.461766Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.469653Z"}}
{"data": {"elapsed": 0.32704908, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-7043-2a66-0301e5fdcf7b", "status": "SUCCESS 8"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 8 in 0.327 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.806994Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.886297Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\ndescribe table \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\"", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:58.895431Z"}}
{"data": {"elapsed": 0.25677967, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-6f39-2a66-0301e5fdd493", "status": "SUCCESS 10"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 10 in 0.257 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:59.161553Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:59.325151Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        \n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n    ) as __dbt_sbq\n    where false\n    limit 0"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        \n\n    with snapshot_query as (\n\n        \n\n    \n\n     select * from REPORTING.TEST_GENERAL.raw_orders\n\n\n    ),\n\n    snapshotted_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n\n        from \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\"\n        where\n            \n                dbt_valid_to is null\n            \n\n    ),\n\n    insertions_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n,\n            md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, \n    \n        id as dbt_unique_key\n    \n,\n            order_date as dbt_updated_at,\n            order_date as dbt_valid_from,\n            order_date as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n            where \n    \n        snapshotted_data.dbt_unique_key is null\n    \n\n            or (\n    \n        snapshotted_data.dbt_unique_key is not null\n    \n and ((snapshotted_data.dbt_valid_from < source_data.order_date))\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on \n    \n        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n    \n\n        where (\n            (snapshotted_data.dbt_valid_from < source_data.order_date)\n        )\n    )\n\n    select * from insertions\n    union all\n    select * from updates\n\n    ) as __dbt_sbq\n    where false\n    limit 0", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:59.333754Z"}}
{"data": {"elapsed": 0.38072532, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-7039-2a66-0301e5fde097", "status": "SUCCESS 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 0 in 0.381 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:59.758529Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:59.822494Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time\n    ) as __dbt_sbq\n    where false\n    limit 0"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time\n    ) as __dbt_sbq\n    where false\n    limit 0", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:58:59.830409Z"}}
{"data": {"elapsed": 0.25331616, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90106-0412-7043-2a66-0301e5fdcfc3", "status": "SUCCESS 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 0 in 0.253 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:00.095233Z"}}
{"data": {"msg": "Writing runtime sql for node \"snapshot.jaffle_shop.orders_snapshot\"", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Writing runtime sql for node \"snapshot.jaffle_shop.orders_snapshot\"", "name": "JinjaLogDebug", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:00.130930Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:00.190240Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nBEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nBEGIN", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:00.198464Z"}}
{"data": {"elapsed": 0.2742594, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90107-0412-6f39-2a66-0301e5fdd4d3", "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 1 in 0.274 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:00.483457Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:00.502113Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nmerge into \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\" as DBT_INTERNAL_DEST\n    using \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\" as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     \n       and DBT_INTERNAL_DEST.dbt_valid_to is null\n     \n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n        values (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n\n;"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nmerge into \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT\" as DBT_INTERNAL_DEST\n    using \"REPORTING\".\"SNAPSHOTS\".\"ORDERS_SNAPSHOT__dbt_tmp\" as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     \n       and DBT_INTERNAL_DEST.dbt_valid_to is null\n     \n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n        values (\"ID\", \"USER_ID\", \"ORDER_DATE\", \"STATUS\", \"DBT_UPDATED_AT\", \"DBT_VALID_FROM\", \"DBT_VALID_TO\", \"DBT_SCD_ID\")\n\n;", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:00.517837Z"}}
{"data": {"elapsed": 0.7854302, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90107-0412-7039-2a66-0301e5fde0d3", "status": "SUCCESS 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 0 in 0.785 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:01.323349Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "snowflake", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Using snowflake connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:01.343588Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nCOMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"snowflake\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nCOMMIT", "name": "SQLQuery", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:01.358393Z"}}
{"data": {"elapsed": 0.57753974, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "01b90107-0412-7043-2a66-0301e5fdf007", "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "SQL status: SUCCESS 1 in 0.578 seconds", "name": "SQLQueryStatus", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:01.945719Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: Close", "name": "ConnectionClosed", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:02.117554Z"}}
{"data": {"cfg": {"column_types": "{}", "contract": "{'enforced': False, 'alias_types': True}", "docs": "{'show': True}", "enabled": "True", "grants": "{}", "materialized": "snapshot", "meta": "{}", "on_configuration_change": "apply", "on_schema_change": "ignore", "packages": "[]", "persist_docs": "{}", "post-hook": "[]", "pre-hook": "[]", "quoting": "{}", "strategy": "timestamp", "tags": "[]", "target_schema": "snapshots", "unique_key": "id", "updated_at": "order_date"}, "description": "snapshots.orders_snapshot", "execution_time": 8.2346525, "index": 1, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "2024-12-13T13:59:02.710853", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "success", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "result_message": "SUCCESS 0", "status": "success", "total": 1}, "info": {"category": "", "code": "Q015", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "1 of 1 OK snapshotted snapshots.orders_snapshot ................................ [SUCCESS 0 in 8.23s]", "name": "LogSnapshotResult", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:02.731341Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "2024-12-13T13:59:02.710853", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "REPORTING", "relation_name": "REPORTING.snapshots.orders_snapshot", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:58:54.455582", "node_status": "success", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "run_result": {"adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "query_id": "01b90107-0412-7039-2a66-0301e5fde0d3", "rows_affected": 0.0}, "execution_time": 8.2346525, "message": "SUCCESS 0", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-12-13T13:58:54.544378Z", "name": "compile", "started_at": "2024-12-13T13:58:54.492194Z"}, {"completed_at": "2024-12-13T13:59:02.116662Z", "name": "execute", "started_at": "2024-12-13T13:58:54.552868Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Finished running node snapshot.jaffle_shop.orders_snapshot", "name": "NodeFinished", "pid": 801, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:59:02.750715Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:02.773771Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Connection 'snapshot.jaffle_shop.orders_snapshot' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:02.783462Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "", "name": "Formatting", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:02.790614Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 16.25 seconds", "execution_time": 16.250778, "stat_line": "1 snapshot"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Finished running 1 snapshot in 0 hours 0 minutes and 16.25 seconds (16.25s).", "name": "FinishedRunningStats", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:02.797153Z"}}
{"data": {"elapsed_time": 16.250778, "generated_at": "2024-12-13T13:59:02Z", "results": [{"adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "query_id": "01b90107-0412-7039-2a66-0301e5fde0d3", "rows_affected": 0.0}, "execution_time": 8.2346525, "message": "SUCCESS 0", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-12-13T13:58:54.544378Z", "name": "compile", "started_at": "2024-12-13T13:58:54.492194Z"}, {"completed_at": "2024-12-13T13:59:02.116662Z", "name": "execute", "started_at": "2024-12-13T13:58:54.552868Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:02.813434Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "", "name": "Formatting", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:03.492138Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Completed successfully", "name": "EndOfRunSummary", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:03.498842Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "", "name": "Formatting", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:03.504901Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:03.518675Z"}}
{"data": {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 31.389671, "process_in_blocks": "0", "process_kernel_time": 0.355041, "process_mem_max_rss": "216628", "process_out_blocks": "8", "process_user_time": 25.7792}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Resource report: {\"command_name\": \"snapshot\", \"command_success\": true, \"command_wall_clock_time\": 31.389671, \"process_user_time\": 25.7792, \"process_kernel_time\": 0.355041, \"process_mem_max_rss\": \"216628\", \"process_out_blocks\": \"8\", \"process_in_blocks\": \"0\"}", "name": "ResourceReport", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:03.527776Z"}}
{"data": {"command": "dbt snapshot", "completed_at": "2024-12-13T13:59:03.535811Z", "elapsed": 31.398685, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Command `dbt snapshot` succeeded at 13:59:03.535811 after 31.40 seconds", "name": "CommandCompleted", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:03.536728Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "08ffd43e-0bcd-4bbe-b30a-b51d8079e94e", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 801, "thread": "MainThread", "ts": "2024-12-13T13:59:03.542468Z"}}
