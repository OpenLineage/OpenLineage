{"data": {"log_version": 3, "version": "=1.8.2"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Running with dbt=1.8.2", "name": "MainReportVersion", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:10.554247Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt snapshot --select orders_snapshot --profiles-dir profiles --log-format json", "log_cache_events": "False", "log_format": "json", "log_path": "/usr/src/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "profiles", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "False", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/src/dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'profiles', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'json', 'invocation_command': 'dbt snapshot --select orders_snapshot --profiles-dir profiles --log-format json', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:10.564778Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Registered adapter: postgres=1.8.2", "name": "AdapterRegistered", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:11.772314Z"}}
{"data": {"checksum": "f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109", "profile": "", "target": "", "vars": "{}", "version": "1.8.2"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2", "name": "StateCheckVarsHash", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:12.186108Z"}}
{"data": {"reason": "saved manifest not found. Starting full parse."}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Unable to do partial parsing because saved manifest not found. Starting full parse.", "name": "UnableToPartialParse", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:12.198979Z"}}
{"data": {"deprecated_path": "tests", "exp_path": "data_tests"}, "info": {"category": "", "code": "D012", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "warn", "msg": "[WARNING]: Deprecated functionality\nThe `tests` config has been renamed to `data_tests`. Please see\nhttps://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more\ninformation.", "name": "TestsConfigDeprecation", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:20.403823Z"}}
{"data": {"stat_line": "5 models, 1 snapshot, 3 seeds, 20 data tests, 428 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Found 5 models, 1 snapshot, 3 seeds, 20 data tests, 428 macros", "name": "FoundStats", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:23.213054Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "", "name": "Formatting", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:23.227209Z"}}
{"data": {"conn_name": "master", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Acquiring new postgres connection 'master'", "name": "NewConnection", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:23.234894Z"}}
{"data": {"conn_name": "list_postgres", "conn_type": "postgres"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Acquiring new postgres connection 'list_postgres'", "name": "NewConnection", "pid": 751, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:45:23.248086Z"}}
{"data": {"conn_name": "list_postgres", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"list_postgres\"", "name": "ConnectionUsed", "pid": 751, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:45:23.436457Z"}}
{"data": {"conn_name": "list_postgres", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"list_postgres\"} */\n\n    select distinct nspname from pg_namespace\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"list_postgres\"} */\n\n    select distinct nspname from pg_namespace\n  ", "name": "SQLQuery", "pid": 751, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:45:23.443473Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 751, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:45:23.449578Z"}}
{"data": {"elapsed": 0.110163294, "query_id": "", "status": "SELECT 5"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: SELECT 5 in 0.110 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:45:23.560559Z"}}
{"data": {"conn_name": "list_postgres"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres: Close", "name": "ConnectionClosed", "pid": 751, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-12-13T13:45:23.577871Z"}}
{"data": {"conn_name": "list_postgres_snapshots", "orig_conn_name": "list_postgres"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_postgres, now list_postgres_snapshots)", "name": "ConnectionReused", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.619385Z"}}
{"data": {"conn_name": "list_postgres_snapshots", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"list_postgres_snapshots\"", "name": "ConnectionUsed", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.658500Z"}}
{"data": {"conn_name": "list_postgres_snapshots", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_snapshots: BEGIN", "name": "SQLQuery", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.665139Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.702901Z"}}
{"data": {"elapsed": 0.0756135, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: BEGIN in 0.076 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.778811Z"}}
{"data": {"conn_name": "list_postgres_snapshots", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"list_postgres_snapshots\"", "name": "ConnectionUsed", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.785632Z"}}
{"data": {"conn_name": "list_postgres_snapshots", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"list_postgres_snapshots\"} */\nselect\n      'postgres' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'snapshots'\n    union all\n    select\n      'postgres' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'snapshots'\n    union all\n    select\n      'postgres' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'snapshots'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_snapshots: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"list_postgres_snapshots\"} */\nselect\n      'postgres' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'snapshots'\n    union all\n    select\n      'postgres' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'snapshots'\n    union all\n    select\n      'postgres' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'snapshots'\n  ", "name": "SQLQuery", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.791667Z"}}
{"data": {"elapsed": 0.004475375, "query_id": "", "status": "SELECT 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: SELECT 1 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.801163Z"}}
{"data": {"conn_name": "list_postgres_snapshots"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_snapshots: ROLLBACK", "name": "Rollback", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.812983Z"}}
{"data": {"conn_name": "list_postgres_snapshots"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_snapshots: Close", "name": "ConnectionClosed", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.818383Z"}}
{"data": {"conn_name": "list_postgres_public", "orig_conn_name": "list_postgres_snapshots"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_postgres_snapshots, now list_postgres_public)", "name": "ConnectionReused", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.829778Z"}}
{"data": {"conn_name": "list_postgres_public", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"list_postgres_public\"", "name": "ConnectionUsed", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.847133Z"}}
{"data": {"conn_name": "list_postgres_public", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_public: BEGIN", "name": "SQLQuery", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.852975Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.858641Z"}}
{"data": {"elapsed": 0.080928, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: BEGIN in 0.081 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.939694Z"}}
{"data": {"conn_name": "list_postgres_public", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"list_postgres_public\"", "name": "ConnectionUsed", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.945989Z"}}
{"data": {"conn_name": "list_postgres_public", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"list_postgres_public\"} */\nselect\n      'postgres' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'public'\n    union all\n    select\n      'postgres' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'public'\n    union all\n    select\n      'postgres' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'public'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_public: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"list_postgres_public\"} */\nselect\n      'postgres' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike 'public'\n    union all\n    select\n      'postgres' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike 'public'\n    union all\n    select\n      'postgres' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike 'public'\n  ", "name": "SQLQuery", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.953076Z"}}
{"data": {"elapsed": 0.004722458, "query_id": "", "status": "SELECT 8"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: SELECT 8 in 0.005 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.973417Z"}}
{"data": {"conn_name": "list_postgres_public"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_public: ROLLBACK", "name": "Rollback", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.985319Z"}}
{"data": {"conn_name": "list_postgres_public"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On list_postgres_public: Close", "name": "ConnectionClosed", "pid": 751, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-12-13T13:45:23.992226Z"}}
{"data": {"conn_name": "master", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"master\"", "name": "ConnectionUsed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.038007Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.044264Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.050478Z"}}
{"data": {"elapsed": 0.07658304, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: BEGIN in 0.077 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.127262Z"}}
{"data": {"conn_name": "master", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"master\"", "name": "ConnectionUsed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.133871Z"}}
{"data": {"conn_name": "master", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"master\"} */\nwith relation as (\n        select\n            pg_rewrite.ev_class as class,\n            pg_rewrite.oid as id\n        from pg_rewrite\n    ),\n    class as (\n        select\n            oid as id,\n            relname as name,\n            relnamespace as schema,\n            relkind as kind\n        from pg_class\n    ),\n    dependency as (\n        select distinct\n            pg_depend.objid as id,\n            pg_depend.refobjid as ref\n        from pg_depend\n    ),\n    schema as (\n        select\n            pg_namespace.oid as id,\n            pg_namespace.nspname as name\n        from pg_namespace\n        where nspname != 'information_schema' and nspname not like 'pg\\_%'\n    ),\n    referenced as (\n        select\n            relation.id AS id,\n            referenced_class.name ,\n            referenced_class.schema ,\n            referenced_class.kind\n        from relation\n        join class as referenced_class on relation.class=referenced_class.id\n        where referenced_class.kind in ('r', 'v', 'm')\n    ),\n    relationships as (\n        select\n            referenced.name as referenced_name,\n            referenced.schema as referenced_schema_id,\n            dependent_class.name as dependent_name,\n            dependent_class.schema as dependent_schema_id,\n            referenced.kind as kind\n        from referenced\n        join dependency on referenced.id=dependency.id\n        join class as dependent_class on dependency.ref=dependent_class.id\n        where\n            (referenced.name != dependent_class.name or\n             referenced.schema != dependent_class.schema)\n    )\n\n    select\n        referenced_schema.name as referenced_schema,\n        relationships.referenced_name as referenced_name,\n        dependent_schema.name as dependent_schema,\n        relationships.dependent_name as dependent_name\n    from relationships\n    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id\n    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id\n    group by referenced_schema, referenced_name, dependent_schema, dependent_name\n    order by referenced_schema, referenced_name, dependent_schema, dependent_name;"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"connection_name\": \"master\"} */\nwith relation as (\n        select\n            pg_rewrite.ev_class as class,\n            pg_rewrite.oid as id\n        from pg_rewrite\n    ),\n    class as (\n        select\n            oid as id,\n            relname as name,\n            relnamespace as schema,\n            relkind as kind\n        from pg_class\n    ),\n    dependency as (\n        select distinct\n            pg_depend.objid as id,\n            pg_depend.refobjid as ref\n        from pg_depend\n    ),\n    schema as (\n        select\n            pg_namespace.oid as id,\n            pg_namespace.nspname as name\n        from pg_namespace\n        where nspname != 'information_schema' and nspname not like 'pg\\_%'\n    ),\n    referenced as (\n        select\n            relation.id AS id,\n            referenced_class.name ,\n            referenced_class.schema ,\n            referenced_class.kind\n        from relation\n        join class as referenced_class on relation.class=referenced_class.id\n        where referenced_class.kind in ('r', 'v', 'm')\n    ),\n    relationships as (\n        select\n            referenced.name as referenced_name,\n            referenced.schema as referenced_schema_id,\n            dependent_class.name as dependent_name,\n            dependent_class.schema as dependent_schema_id,\n            referenced.kind as kind\n        from referenced\n        join dependency on referenced.id=dependency.id\n        join class as dependent_class on dependency.ref=dependent_class.id\n        where\n            (referenced.name != dependent_class.name or\n             referenced.schema != dependent_class.schema)\n    )\n\n    select\n        referenced_schema.name as referenced_schema,\n        relationships.referenced_name as referenced_name,\n        dependent_schema.name as dependent_schema,\n        relationships.dependent_name as dependent_name\n    from relationships\n    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id\n    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id\n    group by referenced_schema, referenced_name, dependent_schema, dependent_name\n    order by referenced_schema, referenced_name, dependent_schema, dependent_name;", "name": "SQLQuery", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.143183Z"}}
{"data": {"elapsed": 0.0054765, "query_id": "", "status": "SELECT 3"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: SELECT 3 in 0.005 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.156213Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: ROLLBACK", "name": "Rollback", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.170449Z"}}
{"data": {"conn_name": "master", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"master\"", "name": "ConnectionUsed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.177943Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.215921Z"}}
{"data": {"elapsed": 0.000817542, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.224573Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.231440Z"}}
{"data": {"conn_name": "master", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"master\"", "name": "ConnectionUsed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.237564Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.243387Z"}}
{"data": {"elapsed": 0.000644166, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.249898Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.257054Z"}}
{"data": {"node_count": 1, "num_threads": 1, "target_name": "pg"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Concurrency: 1 threads (target='pg')", "name": "ConcurrencyLine", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.267544Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "", "name": "Formatting", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:24.273628Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "started", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Began running node snapshot.jaffle_shop.orders_snapshot", "name": "NodeStart", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.294217Z"}}
{"data": {"description": "snapshot snapshots.orders_snapshot", "index": 1, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "started", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "1 of 1 START snapshot snapshots.orders_snapshot ................................ [RUN]", "name": "LogStartLine", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.305618Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "orig_conn_name": "list_postgres_public"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_postgres_public, now snapshot.jaffle_shop.orders_snapshot)", "name": "ConnectionReused", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.315300Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "compiling", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Began compiling node snapshot.jaffle_shop.orders_snapshot", "name": "NodeCompiling", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.321086Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Began executing node snapshot.jaffle_shop.orders_snapshot", "name": "NodeExecuting", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.376460Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "postgres", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.777908Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        \n    \n\n    select *,\n        md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id,\n        order_date as dbt_updated_at,\n        order_date as dbt_valid_from,\n        \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n\n    from (\n        \n\n    \n\n     select * from \"postgres\".\"public\".\"raw_orders\"\n\n    ) sbq\n\n\n\n    ) as __dbt_sbq\n    where false\n    limit 0\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        \n    \n\n    select *,\n        md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id,\n        order_date as dbt_updated_at,\n        order_date as dbt_valid_from,\n        \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n\n    from (\n        \n\n    \n\n     select * from \"postgres\".\"public\".\"raw_orders\"\n\n    ) sbq\n\n\n\n    ) as __dbt_sbq\n    where false\n    limit 0\n", "name": "SQLQuery", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.793067Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.801260Z"}}
{"data": {"elapsed": 0.07848179, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: SELECT 0 in 0.078 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.880021Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "postgres", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.918039Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        select now()::timestamp without time zone as dbt_snapshot_time\n    ) as __dbt_sbq\n    where false\n    limit 0\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\nselect * from (\n        select now()::timestamp without time zone as dbt_snapshot_time\n    ) as __dbt_sbq\n    where false\n    limit 0\n", "name": "SQLQuery", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.925730Z"}}
{"data": {"elapsed": 0.001025375, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "", "status": "SELECT 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: SELECT 0 in 0.001 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.934167Z"}}
{"data": {"msg": "Writing runtime sql for node \"snapshot.jaffle_shop.orders_snapshot\"", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Writing runtime sql for node \"snapshot.jaffle_shop.orders_snapshot\"", "name": "JinjaLogDebug", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:24.944492Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "postgres", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.014844Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: BEGIN", "name": "SQLQuery", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.022556Z"}}
{"data": {"elapsed": 0.00061225, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: BEGIN in 0.001 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.035619Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "postgres", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.043125Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n\n      \n  \n    \n\n  create  table \"postgres\".\"snapshots\".\"orders_snapshot\"\n  \n  \n    as\n  \n  (\n    \n    \n\n    select *,\n        md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id,\n        order_date as dbt_updated_at,\n        order_date as dbt_valid_from,\n        \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n\n    from (\n        \n\n    \n\n     select * from \"postgres\".\"public\".\"raw_orders\"\n\n    ) sbq\n\n\n\n  );\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.2\", \"profile_name\": \"jaffle_shop\", \"target_name\": \"pg\", \"node_id\": \"snapshot.jaffle_shop.orders_snapshot\"} */\n\n      \n  \n    \n\n  create  table \"postgres\".\"snapshots\".\"orders_snapshot\"\n  \n  \n    as\n  \n  (\n    \n    \n\n    select *,\n        md5(coalesce(cast(id as varchar ), '')\n         || '|' || coalesce(cast(order_date as varchar ), '')\n        ) as dbt_scd_id,\n        order_date as dbt_updated_at,\n        order_date as dbt_valid_from,\n        \n  \n  coalesce(nullif(order_date, order_date), null)\n  as dbt_valid_to\n\n    from (\n        \n\n    \n\n     select * from \"postgres\".\"public\".\"raw_orders\"\n\n    ) sbq\n\n\n\n  );\n  \n  ", "name": "SQLQuery", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.049582Z"}}
{"data": {"elapsed": 0.004303917, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "", "status": "SELECT 99"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: SELECT 99 in 0.004 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.062558Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: COMMIT", "name": "SQLCommit", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.185477Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "conn_type": "postgres", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"snapshot.jaffle_shop.orders_snapshot\"", "name": "ConnectionUsed", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.193141Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: COMMIT", "name": "SQLQuery", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.200106Z"}}
{"data": {"elapsed": 0.002012208, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: COMMIT in 0.002 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.218183Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot", "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "executing", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On snapshot.jaffle_shop.orders_snapshot: Close", "name": "ConnectionClosed", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.234657Z"}}
{"data": {"cfg": {"column_types": "{}", "contract": "{'enforced': False, 'alias_types': True}", "docs": "{'show': True}", "enabled": "True", "grants": "{}", "materialized": "snapshot", "meta": "{}", "on_configuration_change": "apply", "on_schema_change": "ignore", "packages": "[]", "persist_docs": "{}", "post-hook": "[]", "pre-hook": "[]", "quoting": "{}", "strategy": "timestamp", "tags": "[]", "target_schema": "snapshots", "unique_key": "id", "updated_at": "order_date"}, "description": "snapshots.orders_snapshot", "execution_time": 0.9274883, "index": 1, "node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "2024-12-13T13:45:25.241354", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "success", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "result_message": "SELECT 99", "status": "success", "total": 1}, "info": {"category": "", "code": "Q015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "1 of 1 OK snapshotted snapshots.orders_snapshot ................................ [SELECT 99 in 0.93s]", "name": "LogSnapshotResult", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.251965Z"}}
{"data": {"node_info": {"materialized": "snapshot", "meta": {}, "node_finished_at": "2024-12-13T13:45:25.241354", "node_name": "orders_snapshot", "node_path": "orders_snapshot.sql", "node_relation": {"alias": "orders_snapshot", "database": "postgres", "relation_name": "\"postgres\".\"snapshots\".\"orders_snapshot\"", "schema": "snapshots"}, "node_started_at": "2024-12-13T13:45:24.292967", "node_status": "success", "resource_type": "snapshot", "unique_id": "snapshot.jaffle_shop.orders_snapshot"}, "run_result": {"adapter_response": {"_message": "SELECT 99", "code": "SELECT", "rows_affected": 99.0}, "execution_time": 0.9274883, "message": "SELECT 99", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-12-13T13:45:24.375604Z", "name": "compile", "started_at": "2024-12-13T13:45:24.326971Z"}, {"completed_at": "2024-12-13T13:45:25.233743Z", "name": "execute", "started_at": "2024-12-13T13:45:24.383175Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Finished running node snapshot.jaffle_shop.orders_snapshot", "name": "NodeFinished", "pid": 751, "thread": "Thread-1 (worker)", "ts": "2024-12-13T13:45:25.262369Z"}}
{"data": {"conn_name": "master", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"master\"", "name": "ConnectionUsed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.278270Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.286787Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.292609Z"}}
{"data": {"elapsed": 0.077485956, "query_id": "", "status": "BEGIN"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: BEGIN in 0.077 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.370264Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.379098Z"}}
{"data": {"conn_name": "master", "conn_type": "postgres"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Using postgres connection \"master\"", "name": "ConnectionUsed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.385789Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.391993Z"}}
{"data": {"elapsed": 0.00066266704, "query_id": "", "status": "COMMIT"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "SQL status: COMMIT in 0.001 seconds", "name": "SQLQueryStatus", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.398335Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.404007Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.443544Z"}}
{"data": {"conn_name": "snapshot.jaffle_shop.orders_snapshot"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Connection 'snapshot.jaffle_shop.orders_snapshot' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.450123Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "", "name": "Formatting", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.456940Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 2.22 seconds", "execution_time": 2.2225287, "stat_line": "1 snapshot"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Finished running 1 snapshot in 0 hours 0 minutes and 2.22 seconds (2.22s).", "name": "FinishedRunningStats", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.464650Z"}}
{"data": {"elapsed_time": 2.2225287, "generated_at": "2024-12-13T13:45:25Z", "results": [{"adapter_response": {"_message": "SELECT 99", "code": "SELECT", "rows_affected": 99.0}, "execution_time": 0.9274883, "message": "SELECT 99", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-12-13T13:45:24.375604Z", "name": "compile", "started_at": "2024-12-13T13:45:24.326971Z"}, {"completed_at": "2024-12-13T13:45:25.233743Z", "name": "execute", "started_at": "2024-12-13T13:45:24.383175Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:25.474206Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "", "name": "Formatting", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:26.064415Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Completed successfully", "name": "EndOfRunSummary", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:26.071037Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "", "name": "Formatting", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:26.078047Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:26.085880Z"}}
{"data": {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.87189, "process_in_blocks": "0", "process_kernel_time": 0.298911, "process_mem_max_rss": "180148", "process_out_blocks": "0", "process_user_time": 20.665995}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Resource report: {\"command_name\": \"snapshot\", \"command_success\": true, \"command_wall_clock_time\": 15.87189, \"process_user_time\": 20.665995, \"process_kernel_time\": 0.298911, \"process_mem_max_rss\": \"180148\", \"process_in_blocks\": \"0\", \"process_out_blocks\": \"0\"}", "name": "ResourceReport", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:26.096190Z"}}
{"data": {"command": "dbt snapshot", "completed_at": "2024-12-13T13:45:26.105203Z", "elapsed": 15.882275, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Command `dbt snapshot` succeeded at 13:45:26.105203 after 15.88 seconds", "name": "CommandCompleted", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:26.106225Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "9a329c7e-e79d-417e-b108-dbbff77249c8", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 751, "thread": "MainThread", "ts": "2024-12-13T13:45:26.112481Z"}}
